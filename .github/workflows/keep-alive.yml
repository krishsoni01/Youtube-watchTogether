name: Keep Render Server Awake

on:
  schedule:
    # Runs every 14 minutes
    - cron: '*/14 * * * *'
  workflow_dispatch: # Allows manual trigger from Actions tab

jobs:
  ping-server:
    runs-on: ubuntu-latest
    
    steps:
      - name: Ping Server Health Endpoint
        run: |
          echo "ðŸ“ Pinging server at $(date)"
          
          response=$(curl -s -o /dev/null -w "%{http_code}" \
            https://youtube-watchtogether.onrender.com/api/auth/wake-up)
          
          echo "Response code: $response"
          
          if [ $response -eq 200 ]; then
            echo "âœ… Server is awake and responding"
          else
            echo "âš ï¸ Server responded with code: $response"
          fi
      
      - name: Log completion
        run: echo "âœ… Keep-alive ping completed at $(date)" >> $GITHUB_STEP_SUMMARY